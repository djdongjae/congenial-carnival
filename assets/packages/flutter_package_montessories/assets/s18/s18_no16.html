<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=no">
    <title>몬테?���? 콘텐�?</title>
    <style>
        svg {
            /*border: 1px solid #000;*/
            display: block;
            margin: 5px auto;
            cursor: crosshair;
            width: 100%;
            height: auto;
        }
    </style>
</head>

<body>

    <?xml version="1.0" encoding="UTF-8"?>
    <svg id="paintSvg" data-name="paintSvg" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="50 176 467 408">
        <!-- Generator: Adobe Illustrator 29.3.0, SVG Export Plug-In . SVG Version: 2.1.0 Build 146)  -->
        <defs>
            <style>
                .st0 {
                    fill: #ea5234;
                }

                .st1 {
                    fill: #62268a;
                }

                .st2 {
                    stroke-width: 2.39px;
                }

                .st2,
                .st3,
                .st4,
                .st5,
                .st6 {
                    fill: #fff;
                }

                .st2,
                .st3,
                .st4,
                .st5,
                .st6,
                .st7,
                .st8 {
                    stroke-miterlimit: 10;
                }

                .st2,
                .st4,
                .st5,
                .st9,
                .st6,
                .st7 {
                    stroke: #231815;
                }

                .st3 {
                    stroke: #202020;
                }

                .st3,
                .st9,
                .st6 {
                    stroke-width: 1.64px;
                }

                .st10 {
                    fill: #ef8567;
                }

                .st4 {
                    stroke-width: 1.03px;
                }

                .st5 {
                    stroke-width: 1.76px;
                }

                .st11 {
                    fill: #343535;
                }

                .st9 {
                    stroke-linecap: round;
                    stroke-linejoin: round;
                }

                .st9,
                .st7 {
                    fill: none;
                }

                .st12 {
                    fill: #446b33;
                }

                .st13 {
                    fill: #231815;
                }

                .st14 {
                    fill: #f6c74e;
                }

                .st15 {
                    fill: #e1328c;
                }

                .st16 {
                    fill: #e8e6e6;
                }

                .st17 {
                    fill: #1a7fc1;
                }

                .st7 {
                    stroke-width: .61px;
                }

                .st8 {
                    fill: #f3f3f3;
                    stroke: #d3d3d4;
                    stroke-width: .69px;
                }

                .st18 {
                    fill: #c1571e;
                }

                .st19 {
                    fill: #ed6d2a;
                }

                .st20 {
                    fill: #898989;
                }
            </style>
        </defs>
        <!-- 마스?�� 그룹 -->
        <defs>
            <clipPath id="clipPath1">
                <use id="clipRef1" href="#fillArea1" />
            </clipPath>
            <clipPath id="clipPath2">
                <use id="clipRef2" href="#fillArea2" />
            </clipPath>
            <clipPath id="clipPath3">
                <use id="clipRef3" href="#fillArea3" />
            </clipPath>
            <clipPath id="clipPath4">
                <use id="clipRef4" href="#fillArea4" />
            </clipPath>
            <clipPath id="clipPath5">
                <use id="clipRef5" href="#fillArea5" />
            </clipPath>
            <clipPath id="clipPath6">
                <use id="clipRef6" href="#fillArea6" />
            </clipPath>
            <clipPath id="clipPath7">
                <use id="clipRef7" href="#fillArea7" />
            </clipPath>
            <clipPath id="clipPath8">
                <use id="clipRef8" href="#fillArea8" />
            </clipPath>
            <clipPath id="clipPath9">
                <use id="clipRef9" href="#fillArea9" />
            </clipPath>
            <clipPath id="clipPath10">
                <use id="clipRef10" href="#fillArea10" />
            </clipPath>
            <clipPath id="clipPath11">
                <use id="clipRef11" href="#fillArea11" />
            </clipPath>
            <clipPath id="clipPath12">
                <use id="clipRef12" href="#fillArea12" />
            </clipPath>
        </defs>
        <rect class="st16" x="87.13" y="181.44" width="136.14" height="78.16" rx="15.91" ry="15.91" />
        <g>
            <path class="st13"
                d="M113.24,204.93v-8.08h8.29v8.08h-8.29ZM119.77,198.27h-4.77v5.23h4.77v-5.23ZM125.26,213.19v-4.83h-9.97v-1.45h11.76v6.28h-1.79ZM122.37,201.32v-1.45h2.89v-4.25h1.77v10.38h-1.77v-4.68h-2.89Z" />
            <path class="st13"
                d="M138.32,197.49c-.11,5.57-3.04,9.72-7.83,12.32l-1.09-1.36c4.17-1.98,6.72-5.68,7.04-9.47h-6.15v-1.49h8.04ZM138.38,204.13v-1.49h3.76v-7.02h1.77v17.55h-1.77v-9.04h-3.76Z" />
            <path class="st13"
                d="M157.78,208.46c-1.83.3-4.7.53-8.27.57h-2.19v-6.91h6.57v-3.47h-6.64v-1.43h8.42v6.34h-6.57v3.98h.53c2.43,0,5.83-.15,7.96-.55l.19,1.47ZM160.9,195.62v17.55h-1.77v-17.55h1.77Z" />
            <path class="st13"
                d="M177.72,205.06c-1.57-.7-3.47-2.36-4.21-4.1-.53,1.81-2.4,3.64-4.42,4.64l-1.08-1.38c2.47-1.06,4.57-3.3,4.57-6.19v-1.7h1.81v1.62c0,2.92,2.36,5.02,4.36,5.72l-1.04,1.38ZM180.76,213.19v-4.77h-9.98v-1.43h11.76v6.21h-1.77ZM180.76,206.04v-10.4h1.77v10.4h-1.77Z" />
            <path class="st13"
                d="M186.89,213.04v-4.15h10.32v-1.28h-10.44v-1.45h5.25v-1.59h-7v-1.4h15.85v1.4h-7.08v1.59h5.19v4.06h-10.32v1.36h10.98v1.47h-12.76ZM187.08,201.76v-5.45h11.8v5.45h-11.8ZM197.08,197.74h-8.23v2.6h8.23v-2.6Z" />
        </g>
        <rect class="st4" x="87.13" y="222.84" width="424.34" height="284.94" rx="22.49" ry="22.49" />
        <g id="colorPalette">
            <rect class="st12" x="62.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st1" x="102.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st15" x="142.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st19" x="182.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st18" x="222.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st10" x="262.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st0" x="302.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st17" x="342.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st14" x="382.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st8" x="422.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st20" x="462.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st11" x="502.23" y="531.8" width="36" height="36" rx="6" ry="6" />
        </g>
        <path class="st5" onmousedown="onclickPath(1)" ontouchstart="onclickPath(1)" id="fillArea1"
            d="M145.89,398.94s-24.26-52.57,16.17-86.27c40.44-33.7,115.92,2.7,118.61,43.13,2.7,40.44-36.39,102.44-80.87,98.4-36.14-3.29-52.57-49.87-53.92-55.26Z" />
        <path class="st5" onmousedown="onclickPath(2)" ontouchstart="onclickPath(2)" id="fillArea2"
            d="M194.57,295.75s13.18-11.98,17.37-11.98l5.99,10.78s20.37-11.98,27.56-1.2c0,0-4.79,7.79-11.38,9.59,0,0,31.75-.6,39.54,21.57,0,0-20.37,13.18-40.14-6.59,0,0-5.99,25.76-25.16,24.56,0,0-16.17,0-21.57-27.56,0,0-6.59,21.57-43.73,6.59,0,0-.6-15.58,35.34-16.17,0,0-12.58-7.79-7.79-13.18,0,0,14.38-3.59,23.96,3.59Z" />
        <polygon class="st5" onmousedown="onclickPath(3)" ontouchstart="onclickPath(3)" id="fillArea3"
            points="202.51 304.59 215.98 304.59 222.72 266.85 199.81 268.2 202.51 304.59" />
        <path class="st5" onmousedown="onclickPath(4)" ontouchstart="onclickPath(4)" id="fillArea4"
            d="M170.58,346.46c-1.89.31-12.48,20.91-1.57,22.46,10.21,1.45,8.09-13.7,1.57-22.46Z" />
        <path class="st5" onmousedown="onclickPath(5)" ontouchstart="onclickPath(5)" id="fillArea5"
            d="M211.24,358.6c-1.89.31-12.48,20.91-1.57,22.46,10.21,1.45,8.09-13.7,1.57-22.46Z" />
        <path class="st5" onmousedown="onclickPath(6)" ontouchstart="onclickPath(6)" id="fillArea6"
            d="M250.56,344.67c-1.89.31-12.48,20.91-1.57,22.46,10.21,1.45,8.09-13.7,1.57-22.46Z" />
        <path class="st5" onmousedown="onclickPath(7)" ontouchstart="onclickPath(7)" id="fillArea7"
            d="M233.93,383.76c-1.89.31-12.48,20.91-1.57,22.46,10.21,1.45,8.09-13.7,1.57-22.46Z" />
        <path class="st5" onmousedown="onclickPath(8)" ontouchstart="onclickPath(8)" id="fillArea8"
            d="M185.41,386.68c-1.89.31-12.48,20.91-1.57,22.46,10.21,1.45,8.09-13.7,1.57-22.46Z" />
        <path class="st5" onmousedown="onclickPath(9)" ontouchstart="onclickPath(9)" id="fillArea9"
            d="M211.92,409.59c-1.89.31-12.48,20.91-1.57,22.46,10.21,1.45,8.09-13.7,1.57-22.46Z" />
        <g>
            <path class="st2" onmousedown="onclickPath(10)" ontouchstart="onclickPath(10)" id="fillArea10"
                d="M369.35,369.32s-10.88-17.99.42-31.38c11.3-13.39,36.4-17.99,46.45-12.13,10.04,5.86,12.13,12.97,14.65,30.96,2.51,17.99,8.79,45.61,12.97,57.33s5.86,29.29,6.7,42.26c.84,12.97,6.28,33.48-2.93,32.22s-20.5-28.87-27.2-36.82c-6.7-7.95-22.6-33.48-26.78-41.84-4.18-8.37-21.76-33.48-24.27-40.59Z" />
            <path class="st9" d="M385.56,337.52s15.48,2.51,20.5-7.53" />
            <path class="st6" onmousedown="onclickPath(11)" ontouchstart="onclickPath(11)" id="fillArea11"
                d="M395.88,336.57s2.76-28.34-2.26-38.8c-5.02-10.46-3.35-35.99,0-41.01s6.7-.42,9.21-.42,6.28-8.37,9.21-7.95c2.93.42,3.35,4.18,3.35,7.11s2.51,5.02,4.6,5.44,1.67,5.02-2.09,8.79c-3.77,3.77-3.77,1.67-2.09,8.37,1.67,6.7,0,6.7-5.44,14.23-5.44,7.53-11,17.07-10.16,43.01l-4.31,1.23Z" />
            <path class="st3" onmousedown="onclickPath(12)" ontouchstart="onclickPath(12)" id="fillArea12"
                d="M396.19,335.95s-10.81-9.21-14.6-39.75c-3.17-25.54-14.7-50.52-25.11-49.38-10.12,1.11,1.67,7.53-9.62,5.02s-14.65-1.67-11.3,5.86c3.35,7.53-5.44,13.39.84,14.65,6.28,1.26,12.97,2.09,11.3,7.53s1.67,8.79,8.79,11.3,26.65,17.87,32.92,45.9c0,0,4.7.82,6.78-1.13Z" />
            <path class="st9" d="M407.01,365.13s15.06,2.93,17.99-4.18" />
            <path class="st9" d="M391.53,391.08s15.48,1.67,18.83-3.77" />
            <path class="st9" d="M414.54,417.02s15.9.42,18.83-4.6" />
            <path class="st9" d="M428.35,450.91s10.46,3.35,13.81-3.77" />
        </g>
        <!-- 그림 ?��?��?�� ?��?��?�� ?��?�� -->
        <g>
            <path class="st13"
                d="M200.28,476.47c-1.04.24-2.35.42-4.24.42v-5.95h3.75v1.22h-2.26v3.5c.8,0,1.63-.1,2.56-.32l.19,1.14ZM197.69,484.77v-3.86h8.26v-1.34h-8.35v-1.22h9.86v3.7h-8.26v1.49h8.77v1.23h-10.28ZM205.27,476.51c-1.12.24-2.71.38-4.59.38v-5.95h3.92v1.22h-2.43v3.52c1.14,0,2.11-.11,2.93-.32l.18,1.15ZM207.45,474.44v3.14h-1.49v-7.59h1.49v3.2h1.99v1.25h-1.99Z" />
            <path class="st13"
                d="M218.25,471.58c-.1,4.72-2.85,8.21-6.91,10.42l-.93-1.15c3.52-1.68,5.94-4.79,6.21-8h-5.54v-1.26h7.17ZM221.1,484.88v-14.89h1.5v14.89h-1.5Z" />
        </g>
        <g>
            <path class="st13"
                d="M394.44,476.59c2.05,0,4.37-.14,5.81-.46l.21,1.2c-1.57.32-4.03.51-6.66.51h-1.5v-6.69h6.75v1.22h-5.27v4.23h.66ZM398.47,484.83c-3.22,0-4.96-1.15-4.96-2.88s1.74-2.91,4.96-2.91,4.99,1.17,4.99,2.91-1.76,2.88-4.99,2.88ZM398.47,480.27c-2.14,0-3.41.67-3.41,1.68s1.26,1.65,3.41,1.65,3.44-.64,3.44-1.65-1.28-1.68-3.44-1.68ZM403.28,475.05v3.78h-1.5v-8.84h1.5v3.81h2.22v1.25h-2.22Z" />
            <path class="st13"
                d="M406.5,478.04v-1.22h9.72c.3-1.25.4-2.87.4-4.58h-8.4v-1.22h9.92c0,2.34-.13,4.23-.43,5.79h2.24v1.22h-13.45ZM408.29,484.35v-4.72h1.5v3.49h8.76v1.23h-10.26Z" />
        </g>
        <!-- ?��?��?���? 그리?�� ?��?�� (마스?�� ?��?��) -->
        <g id="drawingGroup1" clip-path="url(#clipPath1)" style="opacity: 0.5"></g>
        <g id="drawingGroup2" clip-path="url(#clipPath2)"></g>
        <g id="drawingGroup3" clip-path="url(#clipPath3)" style="opacity: 0.5"></g>
        <g id="drawingGroup4" clip-path="url(#clipPath4)"></g>
        <g id="drawingGroup5" clip-path="url(#clipPath5)"></g>
        <g id="drawingGroup6" clip-path="url(#clipPath6)"></g>
        <g id="drawingGroup7" clip-path="url(#clipPath7)"></g>
        <g id="drawingGroup8" clip-path="url(#clipPath8)"></g>
        <g id="drawingGroup9" clip-path="url(#clipPath9)"></g>
        <g id="drawingGroup10" clip-path="url(#clipPath10)" style="opacity: 0.5"></g>
        <g id="drawingGroup11" clip-path="url(#clipPath11)"></g>
        <g id="drawingGroup12" clip-path="url(#clipPath12)"></g>
    </svg>

    <script>
        const svg = document.getElementById("paintSvg");

        // 📌 해상도별 viewBox 자동 설정
        (function setViewBoxByDevice() {
            const w = window.innerWidth;
            const h = window.innerHeight;

            // 삼성
            if (w === 1180 && h === 648) {
                svg.setAttribute("viewBox", "-75 179 750 507");
            }
            // 큐브
            else {
                svg.setAttribute("viewBox", "-75 179 750 507");
            }
        })();

        let clipRef = document.getElementById("clipRef1");
        let drawingGroup = document.getElementById("drawingGroup1"); // 초기 그리�? 그룹??? �? 번째 ?��?��
        let fillArea = document.getElementById("fillArea1");
        let drawing = false;
        let currentPath = null;
        let callFlutter = false;
        let currentColor = "brown"; // ?��?�� 그리�? ?��?��

        // ?��???/축소 �??��
        let scale = 1;
        let lastDistance = 0;
        let currentX = 0, currentY = 0; // ?��?���? ?���?
        let isDragging = false;

        const colorMap = {
            "62.23-531.8": "#446b33",   // st12
            "102.23-531.8": "#62268a",  // st1
            "142.23-531.8": "#e1328c",  // st15
            "182.23-531.8": "#ed6d2a",  // st19
            "222.23-531.8": "#c1571e",  // st18
            "262.23-531.8": "#ef8567",  // st10
            "302.23-531.8": "#ea5234",  // st0
            "342.23-531.8": "#1a7fc1",  // st17
            "382.23-531.8": "#f6c74e",  // st14
            "422.23-531.8": "#f3f3f3",  // st8
            "462.23-531.8": "#898989",  // st20
            "502.23-531.8": "#343535",  // st11
        };

        document.querySelectorAll("#colorPalette rect").forEach((rect) => {
            function setColor() {
                const key = `${rect.getAttribute("x")}-${rect.getAttribute("y")}`;
                const fill = colorMap[key];
                if (fill) {
                    currentColor = fill;
                    console.log(`Color selected: ${currentColor}`);
                }
            }

            rect.addEventListener("click", (e) => {
                e.stopPropagation();
                setColor();
            });

            rect.addEventListener("touchstart", (e) => {
                e.stopPropagation();
                setColor();
            });
        });

        // ?��?�� ?���? ?�� ?��?�� ?��?��?���? ?��?��
        function onclickPath(id) {
            fillArea = document.getElementById(`fillArea${id}`);

            if (!fillArea) return;

            drawingGroup = document.getElementById(`drawingGroup${id}`);

            console.log(`Switched to fillArea${id}`);
        }

        // SVG 좌표 �??�� ?��?��
        function getSVGCoords(event) {
            const point = svg.createSVGPoint();
            let x, y;

            if (event.touches) {
                x = event.touches[0].clientX;
                y = event.touches[0].clientY;
            } else {
                x = event.clientX;
                y = event.clientY;
            }

            point.x = x;
            point.y = y;
            return point.matrixTransform(svg.getScreenCTM().inverse());
        }

        // 경로 ?���? ?��?���? ?��?��?��?�� ?��?��
        function isInsidePath(x, y) {
            const point = svg.createSVGPoint();
            point.x = x;
            point.y = y;
            return fillArea.isPointInFill(point);
        }

        // 그리�? ?��?�� ?��?��
        function startDrawing(e) {
            e.preventDefault();
            const {
                x,
                y
            } = getSVGCoords(e);
            // if (!isInsidePath(x, y)) return;

            drawing = true;
            currentPath = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
            currentPath.setAttribute("stroke", currentColor);
            currentPath.setAttribute("stroke-width", "30");
            currentPath.setAttribute("fill", "none");
            currentPath.setAttribute("stroke-linecap", "round");
            currentPath.setAttribute("points", `${x},${y}`);
            currentPath.setAttribute("pointer-events", "none");
            drawingGroup.appendChild(currentPath);

            resetDrawTimer();
        }

        // 그리�? ?��?�� ?��?��
        function moveDrawing(e) {
            if (!drawing) return;
            e.preventDefault();

            const {
                x,
                y
            } = getSVGCoords(e);
            if (!isInsidePath(x, y)) return;

            let points = currentPath.getAttribute("points");
            points += ` ${x},${y}`;
            currentPath.setAttribute("points", points);
        }

        // 그리�? 종료 ?��?��
        function stopDrawing() {
            drawing = false;
        }

        // Flutter ?���? ?��?��
        function resetDrawTimer() {
            if (!callFlutter) {
                console.log(callFlutter);
                callFlutter = true;
                window.drawCanvas.postMessage(JSON.stringify({
                    data: 'draw'
                }));
            }
        }

        // �? 처리 ?��?��
        function handleZoom(e) {
            if (e.touches.length === 2) {
                let dx = e.touches[0].clientX - e.touches[1].clientX;
                let dy = e.touches[0].clientY - e.touches[1].clientY;
                let distance = Math.sqrt(dx * dx + dy * dy);

                if (lastDistance !== 0) {
                    let delta = distance - lastDistance;
                    scale += delta * 0.005; // �? ?��?��
                    scale = Math.max(1.0, Math.min(2.5, scale)); // �? ?���? (0.5�? ~ 3�?)
                    svg.setAttribute("style", `transform: scale(${scale})`);
                }

                lastDistance = distance; // 마�??�? 거리 ?��?��?��?��
                e.preventDefault(); // 기본 ?��?��(?��?���? ?��)?�� 막음
            }
        }

        // �? 번째 ?���? ?�� 초기?��
        function handleTouchStart(e) {
            if (e.touches.length === 2) {
                let dx = e.touches[0].clientX - e.touches[1].clientX;
                let dy = e.touches[0].clientY - e.touches[1].clientY;
                lastDistance = Math.sqrt(dx * dx + dy * dy); // 초기 거리 계산
            }
        }

        // ?���? ?��?�� ?��
        function handleTouchEnd(e) {
            if (e.touches.length < 2) {
                lastDistance = 0; // ?�� ?���??��?�� ?��?���? ?��?���?�? 초기?��
            }
        }

        // ?��?���? ?��?�� ?��?��
        function handleMouseDown(e) {
            isDragging = true;
            currentX = e.clientX;
            currentY = e.clientY;
            svg.style.cursor = 'grabbing';
        }

        function handleMouseMove(e) {
            if (!isDragging) return;

            const dx = e.clientX - currentX;
            const dy = e.clientY - currentY;
            currentX = e.clientX;
            currentY = e.clientY;

            const transform = svg.getAttribute('transform') || 'translate(0, 0)';
            const regex = /translate\((-?\d+), (-?\d+)\)/;
            const match = transform.match(regex);

            const newX = (match ? parseInt(match[1]) : 0) + dx;
            const newY = (match ? parseInt(match[2]) : 0) + dy;
            svg.setAttribute('transform', `translate(${newX}, ${newY})`);
        }

        function handleMouseUp() {
            isDragging = false;
            svg.style.cursor = 'grab';
        }

        function handleMouseLeave() {
            isDragging = false;
            svg.style.cursor = 'grab';
        }

        // 마우?�� ?��벤트 리스?��
        svg.addEventListener("mousedown", startDrawing);
        svg.addEventListener("mousemove", moveDrawing);
        svg.addEventListener("mouseup", stopDrawing);
        svg.addEventListener("mouseleave", stopDrawing);

        // ?���? ?��벤트 리스?��
        svg.addEventListener("touchstart", function (e) {
            if (e.touches.length === 1) {
                startDrawing(e); // ?�� ?���??��?���? 그리�? ?��?��
            } else if (e.touches.length === 2) {
                handleTouchStart(e); // ?�� ?���??�� �? ?��?��
            }
        });

        svg.addEventListener("touchmove", function (e) {
            if (e.touches.length === 1) {
                moveDrawing(e); // ?�� ?���??��?���? 그리�? ?��?��
            } else if (e.touches.length === 2) {
                handleZoom(e); // ?�� ?���??�� �? 처리
            }
        });

        svg.addEventListener("touchend", function (e) {
            stopDrawing(); // 그리�? 종료
            handleTouchEnd(e); // ?�� ?���??�� 처리 종료
        });
    </script>
</body>

</html>