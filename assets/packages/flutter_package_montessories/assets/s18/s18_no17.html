<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=no">
    <title>몬테소리 콘텐츠</title>
    <style>
        svg {
            /*border: 1px solid #000;*/
            display: block;
            margin: 5px auto;
            cursor: crosshair;
            width: 100%;
            height: auto;
        }
    </style>
</head>

<body>
    <?xml version="1.0" encoding="UTF-8"?>
    <svg id="paintSvg" data-name="paintSvg" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="50 176 467 408">
        <!-- Generator: Adobe Illustrator 29.3.0, SVG Export Plug-In . SVG Version: 2.1.0 Build 146)  -->
        <defs>
            <style>
                .st0 {
                    fill: #ea5234;
                }

                .st1 {
                    fill: #62268a;
                }

                .st2 {
                    stroke-width: 3.36px;
                }

                .st2,
                .st3 {
                    fill: #fff;
                }

                .st2,
                .st3,
                .st4 {
                    stroke: #231815;
                }

                .st2,
                .st3,
                .st4,
                .st5 {
                    stroke-miterlimit: 10;
                }

                .st6 {
                    fill: #ef8567;
                }

                .st3 {
                    stroke-width: 1.03px;
                }

                .st7 {
                    fill: #343535;
                }

                .st8 {
                    fill: #446b33;
                }

                .st9 {
                    fill: #231815;
                }

                .st10 {
                    fill: #f6c74e;
                }

                .st11 {
                    fill: #e1328c;
                }

                .st12 {
                    fill: #e8e6e6;
                }

                .st13 {
                    fill: #1a7fc1;
                }

                .st4 {
                    fill: none;
                    stroke-width: .61px;
                }

                .st5 {
                    fill: #f3f3f3;
                    stroke: #d3d3d4;
                    stroke-width: .69px;
                }

                .st14 {
                    fill: #c1571e;
                }

                .st15 {
                    fill: #ed6d2a;
                }

                .st16 {
                    fill: #898989;
                }
            </style>
        </defs>
        <defs>
            <clipPath id="clipPath1">
                <use id="clipRef1" href="#fillArea1" />
            </clipPath>
            <clipPath id="clipPath2">
                <use id="clipRef2" href="#fillArea2" />
            </clipPath>
            <clipPath id="clipPath3">
                <use id="clipRef3" href="#fillArea3" />
            </clipPath>
            <clipPath id="clipPath4">
                <use id="clipRef4" href="#fillArea4" />
            </clipPath>
            <clipPath id="clipPath5">
                <use id="clipRef5" href="#fillArea5" />
            </clipPath>
            <clipPath id="clipPath6">
                <use id="clipRef6" href="#fillArea6" />
            </clipPath>
            <clipPath id="clipPath7">
                <use id="clipRef7" href="#fillArea7" />
            </clipPath>
            <clipPath id="clipPath8">
                <use id="clipRef8" href="#fillArea8" />
            </clipPath>
            <clipPath id="clipPath9">
                <use id="clipRef9" href="#fillArea9" />
            </clipPath>
        </defs>
        <!-- <rect class="st4" x="47.58" y="89.89" width="503.96" height="503.96" />
        <g>
            <path class="st9" d="M72.89,135.19l-2.73.61v-1.13l3.61-1.68h1.07v15.35h-1.95v-13.14Z" />
            <path class="st9" d="M85.45,134.89h-7.47v-1.64h9.64v1.24l-5.79,13.82h-2.2l5.84-13.42Z" />
            <path class="st9" d="M88.7,146.57h2.16v2.18h-2.16v-2.18Z" />
            <path class="st9"
                d="M109.51,141.72c-1.74-.78-3.86-2.62-4.68-4.56-.59,2.02-2.67,4.05-4.91,5.17l-1.2-1.53c2.75-1.18,5.08-3.67,5.08-6.89v-1.89h2.02v1.81c0,3.25,2.62,5.58,4.85,6.36l-1.15,1.53ZM112.89,150.77v-5.31h-11.11v-1.6h13.08v6.91h-1.97ZM112.89,142.81v-11.57h1.97v11.57h-1.97Z" />
            <path class="st9"
                d="M119.72,150.6v-4.62h11.48v-1.43h-11.61v-1.62h5.84v-1.76h-7.79v-1.55h17.64v1.55h-7.87v1.76h5.77v4.51h-11.48v1.51h12.22v1.64h-14.19ZM119.93,138.04v-6.07h13.12v6.07h-13.12ZM131.06,133.57h-9.15v2.9h9.15v-2.9Z" />
            <path class="st9"
                d="M149.6,145.79c-1.78.23-4.66.42-7.14.55-2.23.1-4.28.15-5.84.17l-.31-1.68c1.87,0,4.16-.02,6.47-.15,2.75-.1,5.06-.25,6.61-.44l.21,1.55ZM142.71,141.82c-2.88,0-5.08-1.81-5.08-4.45s2.23-4.6,5.08-4.6,5.12,1.81,5.12,4.6-2.27,4.45-5.12,4.45ZM142.71,134.43c-1.72,0-3.13,1.24-3.13,2.92s1.41,2.81,3.13,2.81,3.17-1.11,3.17-2.81c0-1.78-1.41-2.92-3.17-2.92ZM152.6,131.22v19.53h-1.95v-19.53h1.95Z" />
            <path class="st9"
                d="M168.5,146.61v-3.61h-7.92v-1.6h17.64v1.6h-7.75v3.61h-1.97ZM162.79,139.39v-7.54h1.97v2.29h9.28v-2.31h1.97v7.56h-13.23ZM162.79,150.16v-5.35h1.97v3.74h11.4v1.62h-13.37ZM174.04,135.71h-9.28v2.08h9.28v-2.08Z" />
            <path class="st9"
                d="M183.89,150.77v-6.3h-4.51v-1.6h17.64v1.6h-4.56v6.3h-1.97v-6.3h-4.62v6.3h-1.97ZM181.42,140.83v-5.25h11.57v-2.02h-11.59v-1.55h13.56v5.1h-11.57v2.16h12.09v1.55h-14.07Z" />
            <path class="st9"
                d="M198.18,141.76v-1.51h17.64v1.51h-17.64ZM200.19,150.39v-4.33h11.61v-1.45h-11.61v-1.49h13.58v4.33h-11.61v1.43h12.24v1.51h-14.21ZM200.4,138.86v-4.14h11.3v-1.36h-11.27v-1.47h13.25v4.18h-11.3v1.3h11.69v1.49h-13.67Z" />
            <path class="st9"
                d="M232.3,140.73c-1.64-.67-3.57-2.1-4.47-4.12-.61,2.02-2.54,3.76-4.7,4.72l-1.2-1.49c2.65-1.03,4.85-3.23,4.85-6.32v-1.6h2.02v1.51c0,3.09,2.52,5.1,4.64,5.79l-1.13,1.49ZM224.91,150.6v-4.98h10.52v-1.68h-10.56v-1.62h12.53v4.79h-10.52v1.87h11.21v1.62h-13.19ZM237.4,137.43v3.88h-1.97v-10.1h1.97v4.58h2.92v1.64h-2.92Z" />
            <path class="st9"
                d="M252.63,145.33c-1.28.21-2.98.4-5.23.52-2.06.1-4.3.17-6.26.17l-.27-1.7h2.71l-.67-8.02,1.97-.25.5,8.23c.65-.02,1.3-.04,1.91-.08.21,0,.4,0,.61-.02l.5-8.15,1.93.21-.69,7.85c1.13-.08,2.04-.19,2.81-.31l.17,1.55ZM241.44,134.66v-1.6h10.62v1.6h-10.62ZM255.15,150.74v-8.4h-3.19v-1.6h3.19v-3.04h-3.19v-1.62h3.19v-4.87h1.97v19.53h-1.97Z" />
            <path class="st9"
                d="M269.68,142.89v3.84h7.87v1.62h-17.64v-1.62h7.79v-3.84h-5.65v-10.31h1.97v3.55h9.41v-3.55h1.97v10.31h-5.73ZM273.44,137.73h-9.41v3.55h9.41v-3.55Z" />
            <path class="st9"
                d="M278.71,147.89v-1.62h6.72v-6.57h1.97v6.57h8.94v1.62h-17.64ZM294.06,136.03c-.04,3.11-.25,5.61-.82,7.96l-1.91-.31c.44-1.66.71-4.39.71-6.7v-2.33h-11.51v-1.62h13.52v3Z" />
            <path class="st9"
                d="M311.64,141.8c-1.34-.67-3.23-2.5-3.8-3.88-.48,1.57-2.18,3.57-3.91,4.54l-1.18-1.43c2.14-1.18,4.09-3.57,4.09-6.42v-2.27h1.91v2.23c0,2.9,2.23,4.96,3.93,5.75l-1.05,1.49ZM317.41,150.77v-5.23h-11.27v-1.6h13.23v6.82h-1.95ZM317.45,143v-5.25h-2.2v5h-1.89v-11.17h1.89v4.56h2.2v-4.91h1.91v11.78h-1.91Z" />
            <path class="st9"
                d="M332.68,141.59c-1.7-.5-4.01-1.93-4.87-3.59-.61,1.68-2.65,3.36-4.83,4.12l-1.09-1.51c2.37-.67,4.54-2.46,4.85-4.64h-4.09v-1.6h10.56v1.6h-4.37c.36,2.1,2.79,3.61,4.83,4.07l-.99,1.55ZM324.95,150.6v-4.83h10.75v-1.55h-10.79v-1.62h12.77v4.66h-10.75v1.72h11.42v1.62h-13.4ZM325.18,132.94v-1.57h5.31v1.57h-5.31ZM335.7,141.57v-10.35h1.97v10.35h-1.97Z" />
            <path class="st9"
                d="M340.51,137.64v-1.62h9.66v1.62h-9.66ZM345.49,146.21c-2.54,0-4.33-1.62-4.33-3.84,0-2.35,1.78-3.82,4.33-3.82s4.28,1.49,4.28,3.82-1.74,3.84-4.28,3.84ZM342.68,134.3v-1.62h5.25v1.62h-5.25ZM345.49,140.14c-1.43,0-2.42.97-2.42,2.23s.99,2.25,2.42,2.25,2.39-.99,2.39-2.25-1.01-2.23-2.39-2.23ZM355.04,150.74v-9.85h-2.02v8.88h-1.89v-18.14h1.89v7.64h2.02v-8.06h1.91v19.53h-1.91Z" />
            <path class="st9"
                d="M369.01,142.89v3.84h7.87v1.62h-17.64v-1.62h7.79v-3.84h-5.65v-10.31h1.97v3.55h9.41v-3.55h1.97v10.31h-5.73ZM372.77,137.73h-9.41v3.55h9.41v-3.55Z" />
            <path class="st9"
                d="M386.56,145.87c-1.45-.99-3.17-3.17-3.76-5.29-.46,2.16-2.1,4.47-4.01,5.79l-1.24-1.39c2.31-1.47,4.28-4.66,4.28-8.59v-3.34h1.91v3.32c0,3.76,1.81,6.72,4.01,8.1l-1.2,1.39ZM388.79,149.78v-10.02h-3.09v-1.62h3.09v-6.49h1.89v18.12h-1.89ZM392.63,150.74v-19.53h1.91v19.53h-1.91Z" />
            <path class="st9"
                d="M396.83,148.27v-1.62h4.24v-3.46l1.97-.06v3.53h5.17v-3.53l1.97.06v3.46h4.28v1.62h-17.64ZM405.65,142.62c-4.37,0-7.26-1.99-7.26-5.04s2.9-5.06,7.26-5.06,7.26,2.02,7.26,5.06-2.9,5.04-7.26,5.04ZM405.65,134.14c-3.15,0-5.23,1.39-5.23,3.44s2.08,3.42,5.23,3.42,5.25-1.39,5.25-3.42-2.08-3.44-5.25-3.44Z" />
            <path class="st9" d="M415.78,146.57h2.16v2.18h-2.16v-2.18Z" />
        </g> -->
        <rect class="st12" x="89.16" y="183.06" width="151.8" height="78.16" rx="16.8" ry="16.8" />
        <rect class="st3" x="89.16" y="224.46" width="424.34" height="284.94" rx="22.49" ry="22.49" />
        <g id="colorPalette">
            <rect class="st8" x="422.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st1" x="102.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st11" x="502.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st15" x="142.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st14" x="382.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st6" x="222.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st0" x="302.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st13" x="342.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st10" x="262.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st5" x="62.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st16" x="462.23" y="531.8" width="36" height="36" rx="6" ry="6" />
            <rect class="st7" x="182.23" y="531.8" width="36" height="36" rx="6" ry="6" />
        </g>
        <path class="st2" onmousedown="onclickPath(1)" ontouchstart="onclickPath(1)" id="fillArea1"
            d="M194.12,461.5s28.18,3.71,33.37-.74l-6.67-50.43,17.06-19.28-4.45-2.97-14.83,12.61-1.48-17.8-14.09-2.97-1.48,18.54-11.12-13.35-5.93,5.93,14.83,14.83-5.19,55.62Z" />
        <path class="st2" onmousedown="onclickPath(2)" ontouchstart="onclickPath(2)" id="fillArea2"
            d="M175.47,287.55s20.15-34.88,53.48-6.2c0,0,42.63-16.28,41.85,29.45,0,0,20.93,3.1,13.95,31,0,0,26.35,19.38,0,37.98,0,0-9.05,38.96-41.69,13.75,0,0-20.32,13.38-28.84-12.97,0,0-11.63,13.95-26.35,4.65,0,0-1.91,32.05-35.28,23.9-30.3-7.41-19.75-39.4-19.75-39.4,0,0-17.05-33.33,14.73-44.18,0,0-6.2-36.43,27.9-37.98Z" />
        <g>
            <path class="st2" onmousedown="onclickPath(3)" ontouchstart="onclickPath(3)" id="fillArea3"
                d="M393.65,462.13s6.05-23.19-12.1-40.84c-18.15-17.65-40.34-26.22-50.92-34.79-10.59-8.57-21.68-22.18-18.66-11.09s14.62,19.16,15.63,28.23,3.03,16.13,12.1,18.66c9.08,2.52,16.64,4.03,18.15,14.12s12.6,17.65,20.67,19.66c8.07,2.02,15.13,6.05,15.13,6.05Z" />
            <path class="st2" onmousedown="onclickPath(4)" ontouchstart="onclickPath(4)" id="fillArea4"
                d="M386.09,381.45l18.66-1.51s-5.55,76.64-.5,82.69c0,0-9.58,2.52-11.09-1.01-1.51-3.53,2.02-70.59-7.06-80.17Z" />
            <path class="st2" onmousedown="onclickPath(5)" ontouchstart="onclickPath(5)" id="fillArea5"
                d="M375.5,301.29s-2.02-14.12,9.58-13.61c11.6.5,9.58,4.54,16.13,4.54s10.59,6.55,10.59,14.62-29.24,14.62-29.24,14.62l-7.06-20.17Z" />
            <path class="st2" onmousedown="onclickPath(6)" ontouchstart="onclickPath(6)" id="fillArea6"
                d="M400.71,308.35s8.07-1.51,11.09-7.06c3.03-5.55,11.6-.5,11.6,5.55s10.59,27.23,8.57,46.89c-2.02,19.66-9.58,34.29-22.69,32.27-13.11-2.02-8.57-77.65-8.57-77.65Z" />
            <path class="st2" onmousedown="onclickPath(7)" ontouchstart="onclickPath(7)" id="fillArea7"
                d="M386.59,309.86s-13.61-16.13-21.18-8.07c-7.56,8.07-7.56,29.75-9.08,42.86s2.52,48.91,27.23,37.31l3.03-72.1Z" />
            <path class="st2" onmousedown="onclickPath(8)" ontouchstart="onclickPath(8)" id="fillArea8"
                d="M376,338.09s1.01-9.08,3.53-20.67c2.52-11.6,7.56-21.68,13.61-19.66s9.58,12.6,14.62,23.19c5.04,10.59,17.14,25.71,12.1,44.87-5.04,19.16-13.61,23.19-18.15,23.7s-43.36,5.55-25.71-51.43Z" />
            <path class="st2" onmousedown="onclickPath(9)" ontouchstart="onclickPath(9)" id="fillArea9"
                d="M403.23,463.13s-7.06-14.62,6.05-37.81c13.11-23.19,39.33-41.85,43.86-47.9s18.66-23.7,16.64-12.1-9.58,23.19-11.09,32.77c-1.51,9.58-1.51,18.15-12.1,22.69-10.59,4.54-5.55,7.06-13.11,19.66-7.56,12.6-30.25,22.69-30.25,22.69Z" />
        </g>
        <g>
            <path class="st9"
                d="M112.2,207.33v-1.47h6.61v-3.74h1.81v3.74h7.77v1.47h-16.2ZM120.22,215.37c-4.01,0-6.25-1.29-6.25-3.34s2.24-3.36,6.25-3.36,6.21,1.29,6.21,3.36-2.2,3.34-6.21,3.34ZM126.47,198.44c0,.68-.02,1.18-.02,1.77-.04,1.6-.23,3.38-.52,4.59l-1.75-.23c.37-1.43.46-3.12.46-4.67h-10.49v-1.47h12.32ZM120.22,210.15c-2.68,0-4.38.68-4.38,1.89s1.7,1.89,4.38,1.89,4.36-.66,4.36-1.89-1.7-1.89-4.36-1.89Z" />
            <path class="st9"
                d="M138.93,199.41c-.12,5.69-3.43,9.89-8.33,12.55l-1.12-1.39c4.24-2.03,7.15-5.77,7.48-9.64h-6.67v-1.52h8.64ZM142.36,215.43v-17.93h1.81v17.93h-1.81Z" />
            <path class="st9"
                d="M147.15,198.94h9.8v1.48h-3.91v.6c0,2.55,2.26,4.57,4.28,5.19l-1,1.45c-1.6-.64-3.43-2.2-4.18-3.84-.58,1.72-2.66,3.61-4.51,4.36l-1.02-1.43c2.33-.85,4.59-3.18,4.59-5.69v-.64h-4.03v-1.48ZM155.5,215.43c-3.84,0-6.04-1.33-6.04-3.47s2.2-3.49,6.04-3.49,6.06,1.35,6.06,3.49-2.18,3.47-6.06,3.47ZM151.31,211.96c0,1.25,1.56,1.99,4.18,1.99s4.2-.73,4.2-1.99-1.54-1.99-4.2-1.99-4.18.73-4.18,1.99ZM156.27,203.5v-1.49h3.36v-4.51h1.81v11.11h-1.81v-5.11h-3.36Z" />
            <path class="st9"
                d="M175.17,211.9c-1.48.19-4.03.39-6.17.5-1.93.12-3.61.15-5.09.15l-.27-1.52c1.41,0,3.05,0,4.76-.08v-1.62c-2.01-.27-3.37-1.45-3.37-3.01,0-1.83,1.79-3.07,4.28-3.07s4.28,1.21,4.28,3.07c0,1.6-1.33,2.76-3.37,3.01v1.5c1.95-.1,3.61-.23,4.78-.39l.17,1.45ZM164.08,202.51v-1.48h10.64v1.48h-10.64ZM166.72,199.85v-1.49h5.11v1.49h-5.11ZM169.31,204.73c-1.41,0-2.41.69-2.41,1.6s1,1.6,2.41,1.6,2.41-.73,2.41-1.6-.96-1.6-2.41-1.6ZM177.93,206.99v8.45h-1.79v-17.93h1.79v7.98h2.76v1.5h-2.76Z" />
            <path class="st9"
                d="M195.96,207.14c-1.6-.71-3.55-2.41-4.3-4.18-.54,1.85-2.45,3.72-4.51,4.74l-1.1-1.41c2.53-1.08,4.67-3.38,4.67-6.33v-1.74h1.85v1.66c0,2.99,2.41,5.13,4.45,5.84l-1.06,1.41ZM199.07,215.45v-4.88h-10.2v-1.47h12.01v6.34h-1.81ZM199.07,208.14v-10.63h1.81v10.63h-1.81Z" />
            <path class="st9"
                d="M205.34,215.3v-4.24h10.55v-1.31h-10.66v-1.49h5.36v-1.62h-7.15v-1.43h16.2v1.43h-7.23v1.62h5.3v4.15h-10.55v1.39h11.22v1.51h-13.04ZM205.53,203.76v-5.57h12.05v5.57h-12.05ZM215.75,199.66h-8.41v2.66h8.41v-2.66Z" />
        </g>
        <g transform="translate(0,6)">
            <path class="st9"
                d="M205.5,477.72c-1.27.32-3.79.49-5.35.52-.35.01-.7.01-1.03.01v-7.2h1.13v6.22c1.32,0,3.78-.14,5.08-.49l.17.94ZM207.38,474.32h1.78v.95h-1.78v5.84h-1.13v-11.15h1.13v4.37Z" />
            <path class="st9"
                d="M214.26,481.12v-3.75h-4.45v-.92h10.07v.92h-4.5v3.75h-1.13ZM211.04,475.1v-4.52h7.59v4.52h-7.59ZM217.51,471.49h-5.34v2.7h5.34v-2.7Z" />
        </g>
        <g transform="translate(0,6)">
            <path class="st9"
                d="M393.19,475.37v-.91h4.62v-1.88h1.13v1.88h4.33v.91h-10.08ZM401.85,481.28c-1.63-.24-3.13-1.13-3.66-1.92-.48.82-2.02,1.73-3.71,1.89l-.55-.86c1.77-.1,3.36-.94,3.63-1.88h-3.17v-.9h7.66v.9h-3.25c.3.96,2.04,1.81,3.59,1.91l-.55.86ZM397.51,470.26c0,1.33-.26,2.71-.56,3.48l-1.09-.22c.25-.54.49-1.46.5-2.35h-2.29v-.91h3.44ZM396.48,477.01v-.91h3.51v.91h-3.51ZM402.12,470.26c0,1.42-.08,2.63-.37,3.48l-1.08-.18c.25-.68.31-1.54.31-2.39h-2.55v-.91h3.69Z" />
        </g>
        <g id="drawingGroup1" clip-path="url(#clipPath1)"></g>
        <g id="drawingGroup2" clip-path="url(#clipPath2)"></g>
        <g id="drawingGroup3" clip-path="url(#clipPath3)"></g>
        <g id="drawingGroup4" clip-path="url(#clipPath4)" style="opacity: 0.5"></g>
        <g id="drawingGroup5" clip-path="url(#clipPath5)" style="opacity: 0.5"></g>
        <g id="drawingGroup6" clip-path="url(#clipPath6)" style="opacity: 0.5"></g>
        <g id="drawingGroup7" clip-path="url(#clipPath7)" style="opacity: 0.5"></g>
        <g id="drawingGroup8" clip-path="url(#clipPath8)"></g>
        <g id="drawingGroup9" clip-path="url(#clipPath9)"></g>
    </svg>

    <script>
        const svg = document.getElementById("paintSvg");

        // 📌 해상도별 viewBox 자동 설정
        (function setViewBoxByDevice() {
            const w = window.innerWidth;
            const h = window.innerHeight;

            // 삼성
            if (w === 1180 && h === 648) {
                svg.setAttribute("viewBox", "-75 179 750 507");
            }
            // 큐브
            else {
                svg.setAttribute("viewBox", "-75 179 750 507");
            }
        })();

        let clipRef = document.getElementById("clipRef1");
        let drawingGroup = document.getElementById("drawingGroup1"); // 초기 그리기 그룹은 첫 번째 영역
        let fillArea = document.getElementById("fillArea1");
        let drawing = false;
        let currentPath = null;
        let callFlutter = false;
        let currentColor = "brown"; // 현재 그리기 색상

        // 확대/축소 변수
        let scale = 1;
        let lastDistance = 0;
        let currentX = 0, currentY = 0; // 드래그 위치
        let isDragging = false;

        const colorMap = {
            "422.23-531.8": "#446b33",  // st8
            "102.23-531.8": "#62268a",  // st1
            "502.23-531.8": "#e1328c",  // st11
            "142.23-531.8": "#ed6d2a",  // st15
            "382.23-531.8": "#c1571e",  // st14
            "222.23-531.8": "#ef8567",  // st6
            "302.23-531.8": "#ea5234",  // st0
            "342.23-531.8": "#1a7fc1",  // st13
            "262.23-531.8": "#f6c74e",  // st10
            "62.23-531.8": "#f3f3f3",  // st5
            "462.23-531.8": "#898989",  // st16
            "182.23-531.8": "#343535",  // st7
        };


        document.querySelectorAll("#colorPalette rect").forEach((rect) => {
            function setColor() {
                const key = `${rect.getAttribute("x")}-${rect.getAttribute("y")}`;
                const fill = colorMap[key];
                if (fill) {
                    currentColor = fill;
                    console.log(`Color selected: ${currentColor}`);
                }
            }

            rect.addEventListener("click", (e) => {
                e.stopPropagation();
                setColor();
            });

            rect.addEventListener("touchstart", (e) => {
                e.stopPropagation();
                setColor();
            });
        });

        // 영역 클릭 시 해당 영역으로 전환
        function onclickPath(id) {
            fillArea = document.getElementById(`fillArea${id}`);

            if (!fillArea) return;

            drawingGroup = document.getElementById(`drawingGroup${id}`);

            console.log(`Switched to fillArea${id}`);
        }

        // SVG 좌표 변환 함수
        function getSVGCoords(event) {
            const point = svg.createSVGPoint();
            let x, y;

            if (event.touches) {
                x = event.touches[0].clientX;
                y = event.touches[0].clientY;
            } else {
                x = event.clientX;
                y = event.clientY;
            }

            point.x = x;
            point.y = y;
            return point.matrixTransform(svg.getScreenCTM().inverse());
        }

        // 경로 내부 점인지 확인하는 함수
        function isInsidePath(x, y) {
            const point = svg.createSVGPoint();
            point.x = x;
            point.y = y;
            return fillArea.isPointInFill(point);
        }

        // 그리기 시작 함수
        function startDrawing(e) {
            e.preventDefault();
            const {
                x,
                y
            } = getSVGCoords(e);
            // if (!isInsidePath(x, y)) return;

            drawing = true;
            currentPath = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
            currentPath.setAttribute("stroke", currentColor);
            currentPath.setAttribute("stroke-width", "30");
            currentPath.setAttribute("fill", "none");
            currentPath.setAttribute("stroke-linecap", "round");
            currentPath.setAttribute("points", `${x},${y}`);
            currentPath.setAttribute("pointer-events", "none");
            drawingGroup.appendChild(currentPath);

            resetDrawTimer();
        }

        // 그리기 이동 함수
        function moveDrawing(e) {
            if (!drawing) return;
            e.preventDefault();

            const {
                x,
                y
            } = getSVGCoords(e);
            if (!isInsidePath(x, y)) return;

            let points = currentPath.getAttribute("points");
            points += ` ${x},${y}`;
            currentPath.setAttribute("points", points);
        }

        // 그리기 종료 함수
        function stopDrawing() {
            drawing = false;
        }

        // Flutter 호출 함수
        function resetDrawTimer() {
            if (!callFlutter) {
                console.log(callFlutter);
                callFlutter = true;
                window.drawCanvas.postMessage(JSON.stringify({
                    data: 'draw'
                }));
            }
        }

        // 줌 처리 함수
        function handleZoom(e) {
            if (e.touches.length === 2) {
                let dx = e.touches[0].clientX - e.touches[1].clientX;
                let dy = e.touches[0].clientY - e.touches[1].clientY;
                let distance = Math.sqrt(dx * dx + dy * dy);

                if (lastDistance !== 0) {
                    let delta = distance - lastDistance;
                    scale += delta * 0.005; // 줌 속도
                    scale = Math.max(1.0, Math.min(2.5, scale)); // 줌 한계 (0.5배 ~ 3배)
                    svg.setAttribute("style", `transform: scale(${scale})`);
                }

                lastDistance = distance; // 마지막 거리 업데이트
                e.preventDefault(); // 기본 동작(스크롤 등)을 막음
            }
        }

        // 첫 번째 터치 시 초기화
        function handleTouchStart(e) {
            if (e.touches.length === 2) {
                let dx = e.touches[0].clientX - e.touches[1].clientX;
                let dy = e.touches[0].clientY - e.touches[1].clientY;
                lastDistance = Math.sqrt(dx * dx + dy * dy); // 초기 거리 계산
            }
        }

        // 터치 끝날 때
        function handleTouchEnd(e) {
            if (e.touches.length < 2) {
                lastDistance = 0; // 두 손가락이 하나로 떨어지면 초기화
            }
        }

        // 드래그 이동 함수
        function handleMouseDown(e) {
            isDragging = true;
            currentX = e.clientX;
            currentY = e.clientY;
            svg.style.cursor = 'grabbing';
        }

        function handleMouseMove(e) {
            if (!isDragging) return;

            const dx = e.clientX - currentX;
            const dy = e.clientY - currentY;
            currentX = e.clientX;
            currentY = e.clientY;

            const transform = svg.getAttribute('transform') || 'translate(0, 0)';
            const regex = /translate\((-?\d+), (-?\d+)\)/;
            const match = transform.match(regex);

            const newX = (match ? parseInt(match[1]) : 0) + dx;
            const newY = (match ? parseInt(match[2]) : 0) + dy;
            svg.setAttribute('transform', `translate(${newX}, ${newY})`);
        }

        function handleMouseUp() {
            isDragging = false;
            svg.style.cursor = 'grab';
        }

        function handleMouseLeave() {
            isDragging = false;
            svg.style.cursor = 'grab';
        }

        // 마우스 이벤트 리스너
        svg.addEventListener("mousedown", startDrawing);
        svg.addEventListener("mousemove", moveDrawing);
        svg.addEventListener("mouseup", stopDrawing);
        svg.addEventListener("mouseleave", stopDrawing);

        // 터치 이벤트 리스너
        svg.addEventListener("touchstart", function (e) {
            if (e.touches.length === 1) {
                startDrawing(e); // 한 손가락으로 그리기 시작
            } else if (e.touches.length === 2) {
                handleTouchStart(e); // 두 손가락 줌 시작
            }
        });

        svg.addEventListener("touchmove", function (e) {
            if (e.touches.length === 1) {
                moveDrawing(e); // 한 손가락으로 그리기 이동
            } else if (e.touches.length === 2) {
                handleZoom(e); // 두 손가락 줌 처리
            }
        });

        svg.addEventListener("touchend", function (e) {
            stopDrawing(); // 그리기 종료
            handleTouchEnd(e); // 두 손가락 처리 종료
        });
    </script>
</body>

</html>